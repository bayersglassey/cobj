
def x: 1
def y: 2


module [local.test]

def f: 1 2 "Hello from f! " str_p p_stack
def g: ='z


module []
def z: 3 "Hello from z! " str_p p_stack

from [local.test]: f

def test:

    null is_null assert
    T is_bool assert
    0 is_int assert
    `xyz is_sym assert
    "abc" is_str assert
    struct() is_struct assert
    dict is_dict assert
    0 null arr is_arr assert
    nil is_nil assert
    nil is_list assert
    list() is_nil assert
    list(1 2) is_nil not assert
    list(1 2) is_list assert
    nil 1 push is_list assert

    1 ='x
    2 ='y
    :
        'x 'y + ='z
    "lalala! " str_p 'z p
    p_stack
    p_vars

    1 1 == assert
    1 1 < not assert
    1 1 <= assert
    1 2 < assert
    1 2 != assert
    1 2 == not assert
    T assert
    F not assert

    1 1 - 0 == assert
    1 1 + 2 == assert
    6 3 / 2 == assert
    2 3 * 6 == assert

    struct: x y z
    T =.y
    struct(a b) "A" =.a "B" =.b =.z
    ='s

    "s: " str_p 's p
    "s.z: " str_p 's .z p

    dict
    "LALA" `a set
    99 `b set
    ='d

    "d: " str_p 'd p
    "d.a: " str_p 'd `a get p

    6 "HA" arr
    "HI" 2 =.$
    "HU" 3 =.$
    ='a

    "a: " str_p 'a p
    "a.2: " str_p 'a 2 .$ p
    "len a: " str_p 'a arr_len p

    @@[]z
    #'z @@[]z == assert

    "And we're back.\n" str_p

    @f
    #@f 2 == assert 1 == assert

    #10 @g
    #'z 3 == assert

    ignore:
        # It shall never come to pass!
        LALALA
        "WAWAWA"
        F assert

    "abc" str_len 3 == assert

    nil 1 push 2 push ='l
    'l list_len 2 == assert
    'l pop 2 == assert pop 1 == assert is_nil assert
    'l head 2 == assert
    'l tail head 1 == assert
    'l tail tail is_nil assert

    "l: " str_p list(1 "ABC" x) p

    `WA
    null

    p_stack
    p_vars
    return
